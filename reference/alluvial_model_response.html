<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>create model response plot — alluvial_model_response • easyalluvial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="create model response plot — alluvial_model_response"><meta property="og:description" content="alluvial plots are capable of displaying higher dimensional data
 on a plane, thus lend themselves to plot the response of a statistical model
 to changes in the input data across multiple dimensions. The practical limit
 here is 4 dimensions. We need the data space (a sensible range of data
 calculated based on the importance of the explanatory variables of the model
 as created by get_data_space and the predictions
 returned by the model in response to the data space."><meta property="og:image" content="https://erblast.github.io/easyalluvial/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-123997499-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123997499-2');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">easyalluvial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_exploration.html">Data Exploration with Alluvial Plots</a>
    </li>
    <li>
      <a href="../articles/model_response.html">Partial Dependence Alluvial Plots - Visualising Model Response</a>
    </li>
    <li>
      <a href="../articles/parcats.html">Interactive Plots with parcats</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/erblast/easyalluvial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>create model response plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/erblast/easyalluvial/blob/HEAD/R/alluvial_model_response.R" class="external-link"><code>R/alluvial_model_response.R</code></a></small>
    <div class="hidden name"><code>alluvial_model_response.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>alluvial plots are capable of displaying higher dimensional data
 on a plane, thus lend themselves to plot the response of a statistical model
 to changes in the input data across multiple dimensions. The practical limit
 here is 4 dimensions. We need the data space (a sensible range of data
 calculated based on the importance of the explanatory variables of the model
 as created by <code><a href="get_data_space.html">get_data_space</a></code> and the predictions
 returned by the model in response to the data space.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">alluvial_model_response</span><span class="op">(</span></span>
<span>  <span class="va">pred</span>,</span>
<span>  <span class="va">dspace</span>,</span>
<span>  <span class="va">imp</span>,</span>
<span>  degree <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  bin_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LL"</span>, <span class="st">"ML"</span>, <span class="st">"M"</span>, <span class="st">"MH"</span>, <span class="st">"HH"</span><span class="op">)</span>,</span>
<span>  col_vector_flow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF0065"</span>, <span class="st">"#009850"</span>, <span class="st">"#A56F2B"</span>, <span class="st">"#005EAA"</span>, <span class="st">"#710500"</span>, <span class="st">"#7B5380"</span>,</span>
<span>    <span class="st">"#9DD1D1"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  params_bin_numeric_pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  pred_train <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stratum_label_size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pred</dt>
<dd><p>vector, predictions, if method = 'pdp' use
<code><a href="get_pdp_predictions.html">get_pdp_predictions</a></code> to calculate predictions</p></dd>


<dt>dspace</dt>
<dd><p>data frame, returned by
<code><a href="get_data_space.html">get_data_space</a></code></p></dd>


<dt>imp</dt>
<dd><p>dataframe, with not more then two columns one of them numeric
containing importance measures and one character or factor column containing
corresponding variable names as found in training data.</p></dd>


<dt>degree</dt>
<dd><p>integer,  number of top important variables to select. For
plotting more than 4 will result in two many flows and the alluvial plot
will not be very readable, Default: 4</p></dd>


<dt>bin_labels</dt>
<dd><p>labels for prediction bins from low to high, Default: c("LL", "ML",
"M", "MH", "HH")</p></dd>


<dt>col_vector_flow, </dt>
<dd><p>character vector, defines flow colours, Default:
c('#FF0065','#009850', '#A56F2B', '#005EAA', '#710500')</p></dd>


<dt>method, </dt>
<dd><p>character vector, one of c('median', 'pdp')</p><dl><dt>median</dt>
<dd><p>sets variables that are not displayed to median mode, use with
regular predictions</p></dd>
 <dt>pdp</dt>
<dd><p>partial dependency plot method, for each
observation in the training data the displayed variable as are set to the
indicated values. The predict function is called for each modified
observation and the result is averaged, calculate predictions using
<code><a href="get_pdp_predictions.html">get_pdp_predictions</a></code></p></dd>
 
</dl><p>. Default: 'median'</p></dd>


<dt>force</dt>
<dd><p>logical, force plotting of over 1500 flows, Default: FALSE</p></dd>


<dt>params_bin_numeric_pred</dt>
<dd><p>list, additional parameters passed to
<code><a href="manip_bin_numerics.html">manip_bin_numerics</a></code> which is applied to the pred
parameter. Default: list( bins = 5, center = T, transform = T, scale = T)</p></dd>


<dt>pred_train</dt>
<dd><p>numeric vector, base the automated binning of the pred vector on
the distribution of the training predictions. This is useful if marginal
histograms are added to the plot later. Default = NULL</p></dd>


<dt>stratum_label_size</dt>
<dd><p>numeric, Default: 3.5</p></dd>


<dt>...</dt>
<dd><p>additional parameters passed to
<code><a href="alluvial_wide.html">alluvial_wide</a></code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>ggplot2 object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>this model visualisation approach follows the "visualising the model
 in the dataspace" principle as described in Wickham H, Cook D, Hofmann H
 (2015) Visualizing statistical models: Removing the blindfold. Statistical
 Analysis and Data Mining 8(4) &lt;doi:10.1002/sam.11271&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="alluvial_wide.html">alluvial_wide</a></code>,
 <code><a href="get_data_space.html">get_data_space</a></code>,
 <code><a href="alluvial_model_response_caret.html">alluvial_model_response_caret</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">df</span> <span class="op">=</span> <span class="va">mtcars2</span><span class="op">[</span>, <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">'ids'</span> <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fu">randomForest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span> <span class="va">disp</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">imp</span> <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">importance</span></span></span>
<span class="r-in"><span><span class="va">dspace</span> <span class="op">=</span> <span class="fu"><a href="get_data_space.html">get_data_space</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">imp</span>, degree <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There was 1 warning in `mutate()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `cyl = (function (f, na_level = "(Missing)") ...`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> `fct_explicit_na()` was deprecated in forcats 1.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `fct_na_value_to_level()` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">easyalluvial</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue to the authors.</span>
<span class="r-in"><span><span class="va">pred</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">dspace</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">alluvial_model_response</span><span class="op">(</span><span class="va">pred</span>, <span class="va">dspace</span>, <span class="va">imp</span>, degree <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="alluvial_model_response-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># partial dependency plotting method</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">pred</span> <span class="op">=</span> <span class="fu"><a href="get_pdp_predictions.html">get_pdp_predictions</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">imp</span></span></span>
<span class="r-in"><span>                            , .f_predict <span class="op">=</span> <span class="fu">randomForest</span><span class="fu">:::</span><span class="va"><a href="https://rdrr.io/pkg/randomForest/man/predict.randomForest.html" class="external-link">predict.randomForest</a></span></span></span>
<span class="r-in"><span>                            , <span class="va">m</span></span></span>
<span class="r-in"><span>                            , degree <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>                            , bins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">alluvial_model_response</span><span class="op">(</span><span class="va">pred</span>, <span class="va">dspace</span>, <span class="va">imp</span>, degree <span class="op">=</span> <span class="fl">3</span>, method <span class="op">=</span> <span class="st">'pdp'</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bjoern Koneswarakantha.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

